(function(e){function t(t){for(var i,c,s=t[0],l=t[1],o=t[2],d=0,h=[];d<s.length;d++)c=s[d],a[c]&&h.push(a[c][0]),a[c]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(h.length)h.shift()();return r.push.apply(r,o||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(i=!1)}i&&(r.splice(t--,1),e=c(c.s=n[0]))}return e}var i={},a={app:0},r=[];function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var o=0;o<s.length;o++)t(s[o]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0000":function(e,t,n){"use strict";var i=n("4b5f"),a=n.n(i);a.a},"47ad":function(e,t,n){},"4ad9":function(e,t,n){e.exports=n.p+"img/imgplaceholder.6bc4db3d.png"},"4b5f":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var i=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("mainview")],1)},r=[],c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"wrapper"}},[i("div",{attrs:{id:"content"}},[i("imgpreview",{staticClass:"ret-preview",attrs:{src:e.rb64,placeholder:n("c058")},nativeOn:{click:function(t){return t.stopPropagation(),e.showResult(t)}}}),i("div",{attrs:{id:"img-pickers"}},[i("div",[i("span",[e._v("显示图")]),i("imgpicker",{staticClass:"img-picker",attrs:{disabled:e.disabled},on:{onPick:function(t){return e.pickFront(t)},onError:function(t){return e.showErr(t)}}},[i("imgpreview",{staticClass:"preview",attrs:{src:e.fb64}})],1)],1),i("el-button",{attrs:{type:"primary",disabled:!(this.fb64&&this.bgb64)},on:{click:e.make}},[e._v("生成")]),i("div",[i("span",[e._v("隐藏图")]),i("imgpicker",{staticClass:"img-picker",attrs:{disabled:e.disabled},on:{onPick:function(t){return e.pickBg(t)},onError:function(t){return e.showErr(t)}}},[i("imgpreview",{staticClass:"preview",attrs:{src:e.bgb64}})],1)],1)],1)],1),i("el-dialog",{attrs:{visible:e.visible,"append-to-body":"","close-on-click-modal":"",title:"点击图片试试效果"},on:{"update:visible":function(t){e.visible=t},closed:e.closeRetPreview}},[i("div",{class:["result",e.bg],on:{click:function(t){return t.stopPropagation(),e.changBg(t)}}},[i("img",{attrs:{src:e.rb64}})])])],1)},s=[],l=(n("0fb7"),n("450d"),n("f529")),o=n.n(l),u=(n("a7cc"),n("df33")),d=n.n(u),h=(n("be4f"),n("896a")),f=n.n(h),p=(n("f4f9"),n("c2cc")),g=n.n(p),v=(n("7a0f"),n("0f6c")),b=n.n(v),m=(n("1951"),n("eedf")),w=n.n(m),k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{click:e.click}},[n("img",{staticClass:"img-preview",attrs:{src:e.getSrc,alt:e.getAlt}})])},y=[],_=n("4ad9"),x={inheritAttrs:!1,props:{src:{default:""},alt:{default:""},placeholder:{default:_}},methods:{click:function(){this.src!==_&&this.$emit("click",this.src)}},computed:{getSrc:function(){return this.src?this.src:this.placeholder},getAlt:function(){return this.alt?this.alt:"预览图"}}},E=x,I=(n("0000"),n("2877")),j=Object(I["a"])(E,k,y,!1,null,null,null),O=j.exports,C=(n("6aa2"),n("795b")),H=n.n(C),P=(n("96cf"),n("3b8d")),$=n("d225"),R=n("b0b4"),B=(n("ac6a"),n("5d73")),D=n.n(B),S=n("a4bb"),M=n.n(S),F=n("0a0d"),A=n.n(F),L=n("2d7d"),U=n.n(L),G=n("b6d0"),N=n.n(G),T=n("bd86"),W=0,z=255,J="temporary";n("6b54");function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e+Math.random().toString().substr(3,t)+A()()}var K=q,Q="display: none;position: absolute;top: 10000px;left:10000px;z-index: -10000",V="tmp-",X=100;function Y(){var e;return e=document.createElement("div"),e.id=J,e.style.cssText=Q,e}var Z=function(){function e(){Object($["a"])(this,e);var t=J;this.baseName=V,this._delHeap=new N.a,this._heap=new U.a,this._element=null,this._element=document.getElementById(t),this._element||(this._element=Y(),document.body.appendChild(this._element))}return Object(R["a"])(e,[{key:"append",value:function(t){var n,i,a;t&&(n=t.id,i=document.getElementById(n),a=e.getInstance(),this._delHeap.has(n)?(i&&(a._element.replaceChild(t,i),this.updateHeap(n)),this._delHeap.delete(n)):(a._element.appendChild(t),this.updateHeap(n)),this.clean())}},{key:"updateHeap",value:function(e){var t;t=A()(),this._heap.set(e,t)}},{key:"create",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n=K(this.baseName),t=document.createElement(e),!t)return null;for(var a=M()(i),r=0;r<a.length;r++){var c=a[r];"id"!==c&&(t.key=i.key)}return t.id=n,this.append(t),document.getElementById(n)}},{key:"removeElement",value:function(e){var t=document.getElementById(e);t&&(this._delHeap.add(e),this._heap.delete(e)),this.clean()}},{key:"clean",value:function(){if(!(this._heap.size<X/2)){var e,t,n=[],i=!0,a=!1,r=void 0;try{for(var c,s=D()(this._heap.keys());!(i=(c=s.next()).done);i=!0){var l=c.value;e=document.getElementById(l),e&&n.push(e)}}catch(u){a=!0,r=u}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}this._delHeap.clear(),t=this.createNewMnt();for(var o=0;o<n.length;o++)t.appendChild(n[o]);this._element.parentNode.replaceChild(t,this._element),this._element=document.getElementById(t.id)}}}],[{key:"init",value:function(){e.getInstance()}},{key:"getInstance",value:function(){return e._instance||(window.tempHandle=new e,e._instance=window.tempHandle),e._instance}}]),e}();Object(T["a"])(Z,"_instance",void 0);var ee=Z,te=function(){function e(){Object($["a"])(this,e)}return Object(R["a"])(e,null,[{key:"calcGray",value:function(e,t,n){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=a.r,c=a.g,s=a.b;return i=r&&c&&s?e*r+t*c+n*s:.299*e+.587*t+.114*n,i}},{key:"create",value:function(t){var n,i,a,r,c,s,l,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(n=ee.getInstance().create("canvas"),!n)throw new Error("元素创建失败");l=t.naturalHeight,o=t.naturalWidth,n.width=o,n.height=l,i=n.getContext("2d"),i.drawImage(t,0,0),r=i.getImageData(0,0,o,l),c=r.data;for(var d=0;d<c.length;d++)a=e.calcGray(c[d],c[d+1],c[d+2]),c[d]=a,c[d+1]=a,c[d+2]=a;return i.putImageData(r,0,0),s=n.toDataURL(u),ee.getInstance().removeElement(n.id),n=null,i=null,{base64:s,pixels:c,width:o,height:l}}}]),e}(),ne=te;function ie(e){var t,n,i,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n=e.src,n?(t=ee.getInstance().create("img"),t?new H.a(function(e,r){t.onload=function(){var r,c,s,l,o;(c=t.naturalHeight,s=t.naturalWidth,a)?(r=ne.create(t),i=r.pixels,n=r.base64):(l=ee.getInstance().create("canvas"),l.height=c,l.width=s,o=l.getContext("2d"),o.drawImage(t,0,0),i=o.getImageData(0,0,s,c).data,ee.getInstance().removeElement(l.id));e({pixels:i,width:s,height:c,src:n})},t.onerror=function(e){r(e)},t.src=n}):(new H.a).reject(new Error("无法创建元素"))):H.a.reject(new Error("非法参数"))}var ae=ie,re=function(){function e(){Object($["a"])(this,e),this.white={},this.black={}}return Object(R["a"])(e,[{key:"makeHideImage",value:function(){var e=Object(P["a"])(regeneratorRuntime.mark(function e(t,n){var i,a,r,c,s,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return",H.a.reject(new Error("缺少图像")));case 2:return r=ee.getInstance().create("canvas"),l=new Image,l.src=t,e.next=7,ae(l,!1);case 7:return this.white=e.sent,l.src=n,e.next=11,ae(l,!1);case 11:return this.black=e.sent,c=Math.max(this.white.width,this.black.width),s=Math.max(this.white.height,this.black.height),i=new Uint8ClampedArray(c*s*4),this.white.offset={width:c-this.white.width?(c-this.white.width)/2:0,height:s-this.white.height?(s-this.white.height)/2:0},this.black.offset={width:c-this.black.width?(c-this.black.width)/2:0,height:s-this.black.height?(s-this.black.height)/2:0},r.width=c,r.height=s,this.making(i,c,s),a=r.getContext("2d"),a.putImageData(new ImageData(i,c),0,0),ee.getInstance().removeElement(r.id),e.abrupt("return",H.a.resolve(r.toDataURL("image/png")));case 24:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"making",value:function(e,t,n){if(e)for(var i=e,a=0;a<t;a++)for(var r=0;r<n;r++){var c=void 0,s=void 0,l=void 0,o=void 0;if(o=(a+r)%2===1,c=!0,o?(s=a-this.white.offset.width,s>this.white.width-1&&(c=!1),l=r-this.white.offset.height,l>this.white.height-1&&(c=!1)):(s=a-this.black.offset.width,s>this.black.width-1&&(c=!1),l=r-this.black.offset.height,l>this.black.height-1&&(c=!1)),c=c&&s>=0&&l>=0,c){var u=void 0,d=0,h=void 0,f=void 0,p=void 0,g=void 0,v=void 0;u=4*(r*t+a)-1,g=o?this.white.pixels:this.black.pixels,v=o?this.white.width:this.black.width,d=4*(l*v+s)-1,h=g[d+1],f=g[d+2],p=g[d+3],o?(i[u+3]=W,i[u+2]=W,i[u+1]=W,i[u+4]=255-ne.calcGray(h,f,p)):(i[u+3]=z,i[u+2]=z,i[u+1]=z,i[u+4]=ne.calcGray(h,f,p))}}}}]),e}(),ce=re,se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"img-picker"},[n("el-input",{staticClass:"url-picker",attrs:{disabled:e.disabled,placeholder:"输入图片地址",type:"url",accept:e.accept},on:{change:function(t){return e.loadFromHttp(t)}},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}}),n("localfileinput",{staticClass:"local-picker",attrs:{disabled:e.disabled},nativeOn:{change:function(t){return t.stopPropagation(),e.loadFromLocal(t)}}},[e._t("default")],2)],1)},le=[],oe=(n("10cb"),n("f3ad")),ue=n.n(oe),de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("label",[e._t("default",[e._v(e._s(e.label))]),n("input",{class:{hidden:e.hidden,hidden:e.hidden},attrs:{type:"file",accept:e.accept,disabled:e.disabled}})],2)])},he=[],fe={inheritAttrs:!1,props:{id:{default:""},label:{type:String,default:"选择本地文件"},hidden:{default:!0},accept:{default:"image/*"},disabled:{default:!1}},data:function(){return{}}},pe=fe,ge=Object(I["a"])(pe,de,he,!1,null,null,null),ve=ge.exports;function be(e){var t,n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";return t=ee.getInstance().create("canvas"),t.height=e.naturalHeight||e.height,t.width=e.naturalWidth||e.width,n=t.getContext("2d"),n.drawImage(e,0,0),i=t.toDataURL(a),ee.getInstance().removeElement(t.id),t=null,n=null,i}var me=be,we=function(){function e(){Object($["a"])(this,e)}return Object(R["a"])(e,null,[{key:"http",value:function(e){if(!/^https{0,1}:\/{2}/.test(e))return H.a.reject(new Error("图片地址错误"));var t=new Image;return t.crossOrigin="anonymous",new H.a(function(n,i){t.onload=function(){n(me(t))},t.onerror=function(e){i(new Error("image load error"))},t.src=e})}},{key:"local",value:function(e){var t=new FileReader;return new H.a(function(n,i){t.onload=function(){n(t.result)},t.onerror=function(e){i(new Error("image load error"))},t.readAsDataURL(e)})}}]),e}(),ke=we;i["default"].use(ue.a);var ye={components:{localfileinput:ve},props:{disabled:{default:!1},accept:{default:"image/*"}},data:function(){return{url:"",path:"",base64:""}},methods:{change:function(e){this.$emit("onPick",e)},loadFromHttp:function(e){var t=this;ke.http(e).then(function(e){t.base64=e,t.$emit("onPick",t.base64)}).catch(function(e){t.$emit("onError",e)})},loadFromLocal:function(e){var t=this,n=e.target.files;ke.local(n[0]).then(function(e){t.base64=e,t.$emit("onPick",t.base64)}).catch(function(e){t.$emit("onError",e)})}}},_e=ye,xe=(n("8c15"),Object(I["a"])(_e,se,le,!1,null,"170dd7fe",null)),Ee=xe.exports;i["default"].use(w.a),i["default"].use(b.a),i["default"].use(g.a),i["default"].use(f.a),i["default"].use(d.a);var Ie={components:{imgpreview:O,imgpicker:Ee},data:function(){return{rb64:"",fb64:"",bgb64:"",disabled:!1,visible:!1,bg:"white"}},methods:{make:function(){var e=this;if(this.fb64&&this.bgb64){this.disabled=!0;var t=this.$loading({lock:!0,text:"正在隐藏...",background:"rgba(0, 0, 0, 0.7)"}),n=o.a,i=new ce;i.makeHideImage(this.fb64,this.bgb64).then(function(t){e.rb64=t,n({message:"隐藏成功",type:"success"})}).catch(function(e){n({message:"隐藏失败",type:"error"})}).finally(function(){e.disabled=!1,t.close()})}},showErr:function(e){o()({message:e,type:"error"})},showResult:function(){this.rb64&&(this.visible=!0)},closeRetPreview:function(){this.bg="white"},pickFront:function(e){e&&(this.fb64=e)},pickBg:function(e){e&&(this.bgb64=e)},changBg:function(){this.bg="white"===this.bg?"black":"white"}}},je=Ie,Oe=(n("e47a"),Object(I["a"])(je,c,s,!1,null,null,null)),Ce=Oe.exports,He={name:"app",components:{mainview:Ce}},Pe=He,$e=(n("5c0b"),Object(I["a"])(Pe,a,r,!1,null,null,null)),Re=$e.exports;i["default"].config.productionTip=!1,new i["default"]({render:function(e){return e(Re)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var i=n("5e27"),a=n.n(i);a.a},"5e27":function(e,t,n){},"8c15":function(e,t,n){"use strict";var i=n("e0de"),a=n.n(i);a.a},c058:function(e,t,n){e.exports=n.p+"img/retpreview.2247b169.png"},e0de:function(e,t,n){},e47a:function(e,t,n){"use strict";var i=n("47ad"),a=n.n(i);a.a}});
//# sourceMappingURL=app.68f320ff.js.map